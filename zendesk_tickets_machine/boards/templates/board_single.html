{% extends "base.html" %}
{% load staticfiles %}
{% block title %}{{ board_name }} | {% endblock %}
{% block body %}
  <a href="{% url 'logout' %}">logout</a>
  <h1>{{ board_name }}</h1>
  <form method="post">
    {% csrf_token %}
    <div class="row">
      <div class="col-md-4">
        <div class="form-group">
          <label class="sr-only" for="subject">Subject</label>
          {{ form.subject }}
        </div>
        <div class="form-group">
          <label class="sr-only" for="requester">Requester</label>
          {{ form.requester }}
        </div>
        <div class="form-group">
          <label for="created_by">Created By</label>
          {{ form.created_by }}
        </div>
        <div class="form-group">
          <label class="sr-only" for="comment">Comment</label>
          {{ form.comment }}
        </div>
        <div class="form-group">
          <label class="sr-only" for="tags">Tags</label>
          {{ form.tags }}
        </div>
      </div>
      <div class="col-md-4">
        <div class="form-group">
          <label for="assignee">Assignee</label>
          {{ form.assignee }}
        </div>
        <div class="form-group">
          <label for="group">Group</label>
          {{ form.group }}
        </div>
        <div class="form-group">
          <label for="ticket_type">Ticket Type</label>
          {{ form.ticket_type }}
        </div>
        <div class="form-group" id="due_at" style="display:none">
          <label for="due_at">Due Date</label>
          {{ form.due_at }}
        </div>
        <div class="form-group">
          <label for="priority">Priority</label>
          {{ form.priority }}
        </div>
      </div>
      <div class="col-md-4">
        <div class="form-group">
          <label class="sr-only" for="private_comment">Private Comment</label>
          {{ form.private_comment }}
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-md-12">
        <button type="submit" class="btn btn-default">Add New Ticket</button>
      </div>
    </div>
    {{ form.board }}
  </form>
  <hr />
  <div>
    <a href="{% url 'board_tickets_create' board_slug %}" class="btn btn-success" style="margin-bottom: 10px;">Create Tickets</a>
    <a href="{% url 'board_reset' board_slug %}" class="btn btn-warning pull-right">Reset Tickets</a>
    <a href="{% url 'board_requesters_reset' board_slug %}" class="btn btn-warning pull-right" style="margin-right: 5px;">Reset Requesters</a>
  </div>

  <table class="table table-bordered table-condensed table-hover">
    <tr class="active">
    {% spaceless %}
      <th width="7%"></th>
      <th>Subject</th>
      <th>Comment</th>
      <th>Requester</th>
      <th>Created By</th>
      <th>Assignee</th>
      <th>Group</th>
      <th>Ticket Type</th>
      <th>Due Date</th>
      <th>Priority</th>
      <th>Tags</th>
      <th>Private Comment</th>
      <th>Zendesk Ticket ID</th>
    {% endspaceless %}
    </tr>
    {% for each in tickets %}
      {% spaceless %}
      <tr>
        <td><a href="{% url 'ticket_edit' each.id %}">Edit</a> | <a href="{% url 'ticket_delete' each.id %}">Delete</a></td>
        <td>{{ each.subject }}</td>
        <td>{{ each.comment }}</td>
        <td>{{ each.requester }}</td>
        <td>{% if each.created_by %}{{ each.created_by }}{% else %}---{% endif %}</td>
        <td>{% if each.assignee %}{{ each.assignee }}{% else %}---{% endif %}</td>
        <td>{{ each.group }}</td>
        <td>{% if each.ticket_type %}{{ each.ticket_type }}{% else %}---{% endif %}</td>
        <td>{{ each.due_at|date:"M d, Y" }}</td>
        <td>{{ each.priority }}</td>
        <td>{{ each.tags }}</td>
        <td>{{ each.private_comment }}</td>
        <td>{% if each.zendesk_ticket_id %}<a href="{{ zendesk_ticket_url }}{{ each.zendesk_ticket_id }}" target="_blank">{{ each.zendesk_ticket_id }}</a>{% else %}{% endif %}</td>
      </tr>
      {% endspaceless %}
    {% endfor %}
  </table>
{% endblock %}
{% block javascript %}
<script src="{% static 'js/app.js' %}" type="text/javascript"></script>
{% endblock %}
